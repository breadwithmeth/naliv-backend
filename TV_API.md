# TV API

Документация эндпоинта для получения активных скидок и акций магазина по бизнес-токену.

## Аутентификация
- Используется бизнес-токен из таблицы `businesses.token`.
- Передавайте в заголовке: `Authorization: Bearer <business_token>`.

## Получение активных акций и скидок магазина
- **URL:** `GET /api/tv/promotions`
- **Описание:** Возвращает активные акции и скидки для авторизованного магазина вместе с деталями по товарам.
- **Требуется токен бизнеса:** Да (Bearer).

### Параметры запроса
- Отсутствуют. Фильтрация выполняется по бизнесу, указанному в токене, и по текущей дате (`start_promotion_date <= now <= end_promotion_date`, `visible = 1`).

### Успешный ответ (200)
```json
{
  "success": true,
  "data": {
    "business": {
      "business_id": 123,
      "name": "My Store",
      "uuid": "..."
    },
    "promotions": [
      {
        "marketing_promotion_id": 10,
        "name": "Скидка 10%",
        "internal_name": "Promo 10",
        "cover": "https://.../cover.jpg",
        "start_promotion_date": "2025-02-01T00:00:00.000Z",
        "end_promotion_date": "2025-02-28T23:59:59.000Z",
        "details": [
          {
            "detail_id": 100,
            "item_id": 555,
            "item_name": "Товар",
            "item_code": "SKU123",
            "type": "PERCENT",
            "name": "-10%",
            "discount": 10,
            "base_amount": null,
            "add_amount": null
          }
        ]
      }
    ],
    "promotions_count": 1
  },
  "message": "Активные скидки и акции для бизнеса получены"
}
```

### Возможные ошибки
- **401** `Токен доступа бизнеса не предоставлен` — отсутствует заголовок `Authorization` или неверный формат.
- **401** `Недействительный токен бизнеса или бизнес отключен` — токен не найден или бизнес отключен (`enabled != 1`).
- **500** `Ошибка получения данных` — непредвиденная ошибка сервера.

### Замечания
- Отдаются только акции с `visible = 1` и актуальным периодом.
- В `promotions[].name` подставляется `public_name`, если оно задано, иначе `name`.
- `details` включает данные по товарам (имя и код, если найдены в `items`).
