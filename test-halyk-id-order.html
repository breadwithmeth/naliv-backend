<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å halyk_id</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .response {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .full-width {
            grid-column: 1 / -1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõí –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å halyk_id</h1>
        <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–ø–∏—Å–∞–Ω–∏–µ–º –ø–æ —Ç–æ–∫–µ–Ω—É –∫–∞—Ä—Ç—ã Halyk Bank</p>
    </div>

    <div class="container">
        <h2>üìù –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–∫–∞–∑–∞</h2>
        <div class="grid">
            <div class="form-group">
                <label for="jwt-token">JWT —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="jwt-token" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...">
            </div>
            
            <div class="form-group">
                <label for="business-id">ID –±–∏–∑–Ω–µ—Å–∞:</label>
                <input type="number" id="business-id" value="2">
            </div>

            <div class="form-group">
                <label for="halyk-id">Halyk ID (—Ç–æ–∫–µ–Ω –∫–∞—Ä—Ç—ã):</label>
                <input type="text" id="halyk-id" placeholder="abc123def456" value="test-halyk-card-token">
            </div>

            <div class="form-group">
                <label for="delivery-type">–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
                <select id="delivery-type">
                    <option value="DELIVERY">DELIVERY</option>
                    <option value="PICKUP">PICKUP</option>
                    <option value="SCHEDULED">SCHEDULED</option>
                </select>
            </div>

            <div class="form-group">
                <label for="street">–£–ª–∏—Ü–∞:</label>
                <input type="text" id="street" value="—É–ª. –¢–µ—Å—Ç–æ–≤–∞—è">
            </div>

            <div class="form-group">
                <label for="house">–î–æ–º:</label>
                <input type="text" id="house" value="10">
            </div>

            <div class="form-group">
                <label for="apartment">–ö–≤–∞—Ä—Ç–∏—Ä–∞:</label>
                <input type="text" id="apartment" value="15">
            </div>

            <div class="form-group">
                <label for="entrance">–ü–æ–¥—ä–µ–∑–¥:</label>
                <input type="text" id="entrance" value="2">
            </div>

            <div class="form-group">
                <label for="floor">–≠—Ç–∞–∂:</label>
                <input type="text" id="floor" value="3">
            </div>

            <div class="form-group">
                <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                <input type="text" id="comment" value="–ö–æ–¥ –¥–æ–º–æ—Ñ–æ–Ω–∞ 1234">
            </div>

            <div class="form-group">
                <label for="lat">–®–∏—Ä–æ—Ç–∞:</label>
                <input type="number" id="lat" step="any" value="52.271643">
            </div>

            <div class="form-group">
                <label for="lon">–î–æ–ª–≥–æ—Ç–∞:</label>
                <input type="number" id="lon" step="any" value="76.950011">
            </div>

            <div class="form-group full-width">
                <label for="items">–¢–æ–≤–∞—Ä—ã (JSON):</label>
                <textarea id="items" rows="6" placeholder='[{"item_id": 100, "amount": 2}]'>[
  {
    "item_id": 100,
    "amount": 2,
    "options": [
      {
        "option_item_relation_id": 10,
        "amount": 1
      }
    ]
  }
]</textarea>
            </div>

            <div class="form-group">
                <label for="bonus">–ë–æ–Ω—É—Å—ã –∫ —Å–ø–∏—Å–∞–Ω–∏—é:</label>
                <input type="number" id="bonus" value="0">
            </div>

            <div class="form-group">
                <label for="scheduled-type">–¢–∏–ø –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
                <select id="scheduled-type">
                    <option value="ASAP">ASAP</option>
                    <option value="TODAY">TODAY</option>
                    <option value="SCHEDULED">SCHEDULED</option>
                </select>
            </div>

            <div class="form-group">
                <label for="time-slot">–í—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–æ—Ç:</label>
                <input type="text" id="time-slot" value="14:00-16:00">
            </div>

            <div class="form-group">
                <label for="scheduled-date">–î–∞—Ç–∞ (–¥–ª—è SCHEDULED):</label>
                <input type="date" id="scheduled-date">
            </div>
        </div>

        <button onclick="createOrder()">üöÄ –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ —Å halyk_id</button>
    </div>

    <div class="container">
        <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
        <div id="response" class="response"></div>
    </div>

    <script>
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤—Ç—Ä–∞—à–Ω—é—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        document.getElementById('scheduled-date').value = new Date(Date.now() + 24*60*60*1000).toISOString().split('T')[0];

        async function createOrder() {
            const responseDiv = document.getElementById('response');
            responseDiv.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';
            responseDiv.className = 'response';

            try {
                const jwtToken = document.getElementById('jwt-token').value;
                if (!jwtToken) {
                    throw new Error('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å JWT —Ç–æ–∫–µ–Ω');
                }

                const items = JSON.parse(document.getElementById('items').value);

                const requestData = {
                    business_id: parseInt(document.getElementById('business-id').value),
                    halyk_id: document.getElementById('halyk-id').value,
                    street: document.getElementById('street').value,
                    house: document.getElementById('house').value,
                    apartment: document.getElementById('apartment').value,
                    entrance: document.getElementById('entrance').value,
                    floor: document.getElementById('floor').value,
                    comment: document.getElementById('comment').value,
                    lat: parseFloat(document.getElementById('lat').value),
                    lon: parseFloat(document.getElementById('lon').value),
                    items: items,
                    bonus: parseInt(document.getElementById('bonus').value),
                    delivery_type: document.getElementById('delivery-type').value,
                    scheduled_delivery: {
                        type: document.getElementById('scheduled-type').value,
                        time_slot: document.getElementById('time-slot').value,
                        date: document.getElementById('scheduled-date').value
                    }
                };

                console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ:', requestData);

                const response = await fetch('/api/orders/create-user-order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${jwtToken}`
                    },
                    body: JSON.stringify(requestData)
                });

                const data = await response.json();

                if (response.ok) {
                    responseDiv.textContent = `‚úÖ –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!\n\n${JSON.stringify(data, null, 2)}`;
                    responseDiv.className = 'response success';
                } else {
                    responseDiv.textContent = `‚ùå –û—à–∏–±–∫–∞: ${response.status} ${response.statusText}\n\n${JSON.stringify(data, null, 2)}`;
                    responseDiv.className = 'response error';
                }

            } catch (error) {
                responseDiv.textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                responseDiv.className = 'response error';
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–∞
        function setTestToken() {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('jwt-token').value = 'your-test-jwt-token-here';
        }
    </script>
</body>
</html>
