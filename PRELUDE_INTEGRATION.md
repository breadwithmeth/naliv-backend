# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prelude SMS API v2

## –û–±–∑–æ—Ä
–°–∏—Å—Ç–µ–º–∞ SMS-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å Prelude API v2, —Å–ª–µ–¥—É—è —Ç–æ–π –∂–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, —á—Ç–æ –∏ –≤ PHP –∫–æ–¥–µ.

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ (`/api/auth/send-code`)
- **–°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è**: –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ —á–µ—Ä–µ–∑ SMS API
- **–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ–º Prelude API v2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç**: `https://api.prelude.dev/v2/verification`
- **–ú–µ—Ç–æ–¥**: POST

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ (`/api/auth/verify-code`)
- **–°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è**: –ü—Ä–æ–≤–µ—Ä—è–ª–∏ –∫–æ–¥ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è**: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–¥ —á–µ—Ä–µ–∑ Prelude API v2
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç**: `https://api.prelude.dev/v2/verification/check`
- **–ú–µ—Ç–æ–¥**: POST

## API –°—Ç—Ä—É–∫—Ç—É—Ä–∞

### –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞
```typescript
// –ó–∞–ø—Ä–æ—Å –∫ Prelude
{
  "target": {
    "type": "phone_number",
    "value": "+77077707600"
  }
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
```typescript
// –ó–∞–ø—Ä–æ—Å –∫ Prelude
{
  "target": {
    "type": "phone_number", 
    "value": "+77077707600"
  },
  "code": "1234"
}

// –û—Ç–≤–µ—Ç –æ—Ç Prelude
{
  "status": "success" // –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å—Ç–∞—Ç—É—Å
}
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```env
PRELUDE_API_URL=https://api.prelude.dev/v2/verification
PRELUDE_CHECK_URL=https://api.prelude.dev/v2/verification/check
PRELUDE_API_KEY=sk_wIM7kLqD9rKaFfUkAawgQtY3VKWVWkj3
```

## –§—É–Ω–∫—Ü–∏–∏

### `sendSMSViaPrelude(phoneNumber: string)`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ –æ—Ç–ø—Ä–∞–≤–∫—É –∫–æ–¥–∞ —á–µ—Ä–µ–∑ Prelude
- –ù–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–¥ –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä (–∫–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è Prelude)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `boolean` - —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏

### `checkVerificationCodeViaPrelude(phoneNumber: string, code: string)`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ —á–µ—Ä–µ–∑ Prelude API
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `boolean` - –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–¥–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `result.status === 'success'`

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `phone_number_verify`
- `onetime_code` —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç `'PRELUDE'` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ Prelude API

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:
- –ö–æ–¥ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –Ω–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Prelude
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –∫–æ–¥ –∏–∑ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã
- Prelude —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ –∫–æ–¥–∞
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è

### üîí –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ:
- –ö–æ–¥—ã –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ API –æ—Ç–≤–µ—Ç–∞—Ö
- –ö–æ–¥—ã –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π Prelude API
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∫–æ–¥–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞:
```bash
curl -X POST http://localhost:3000/api/auth/send-code \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "+77077707600"}'
```

### –ó–∞–ø—Ä–æ—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–¥–∞:
```bash
curl -X POST http://localhost:3000/api/auth/verify-code \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "+77077707600", "onetime_code": "1234"}'
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PHP

–ù–æ–≤–∞—è TypeScript —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å PHP –∫–æ–¥–æ–º:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Prelude
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–∞–∫–∞—è –∂–µ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π API –∫–ª—é—á –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## –ú–∏–≥—Ä–∞—Ü–∏—è

–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É:
1. ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–º–æ–≥—É—Ç –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
2. ‚úÖ –°—Ç–∞—Ä—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã –±—É–¥—É—Ç –æ—á–∏—â–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. ‚úÖ –ë–æ–Ω—É—Å–Ω—ã–µ –∫–∞—Ä—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
4. ‚úÖ JWT –∏ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ

## –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ Prelude v2
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ Prelude v2  
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–Ω—É—Å–Ω—ã—Ö –∫–∞—Ä—Ç
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–∫–æ–¥—ã –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PHP –≤–µ—Ä—Å–∏–µ–π
