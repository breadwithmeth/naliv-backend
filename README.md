# Naliv Backend

TypeScript backend –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫–∞–∑–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Node.js** + **TypeScript**
- **Express.js** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Prisma ORM** - —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **MySQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **JWT** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **bcryptjs** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
DATABASE_URL="mysql://username:password@host:port/database"
JWT_SECRET="your-secret-key"
PORT=3000
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
```bash
npx prisma generate
```

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
npm run dev
```

### –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```bash
npm run build
npm start
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- **[–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API](./API_DOCUMENTATION.md)** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **[–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](./API_EXAMPLES.md)** - curl –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞–∫–∞–∑—ã
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ –æ–ø—Ü–∏—è–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö –∞–∫—Ü–∏–π (SUBTRACT, DISCOUNT)
- ‚úÖ –¢–∏–ø—ã –¥–æ—Å—Ç–∞–≤–∫–∏: –æ–±—ã—á–Ω–∞—è, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è, —Å–∞–º–æ–≤—ã–≤–æ–∑
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤ –∏ –∏—Ö –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ID –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö –∞–∫—Ü–∏–π

### –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- ‚úÖ –†–æ–ª–∏: OPERATOR, MANAGER, ADMIN
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
- ‚úÖ –ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞

### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞–º–∏ –∏ –∏—Ö —Ç–æ–≤–∞—Ä–∞–º–∏
- ‚úÖ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å –∑–æ–Ω–∞–º–∏ –∏ —Ä–∞—Å—á–µ—Ç–æ–º –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex API –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
- ‚úÖ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–∫—Ü–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ controllers/        # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
‚îÇ   ‚îú‚îÄ‚îÄ authController.ts
‚îÇ   ‚îú‚îÄ‚îÄ businessController.ts
‚îÇ   ‚îú‚îÄ‚îÄ categoryController.ts
‚îÇ   ‚îú‚îÄ‚îÄ deliveryController.ts
‚îÇ   ‚îú‚îÄ‚îÄ employeeAuthController.ts
‚îÇ   ‚îú‚îÄ‚îÄ orderController.ts
‚îÇ   ‚îú‚îÄ‚îÄ userController.ts
‚îÇ   ‚îî‚îÄ‚îÄ userItemsController.ts
‚îú‚îÄ‚îÄ middleware/         # Middleware —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îú‚îÄ‚îÄ employeeAuth.ts
‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.ts
‚îú‚îÄ‚îÄ routes/            # –ú–∞—Ä—à—Ä—É—Ç—ã API
‚îÇ   ‚îú‚îÄ‚îÄ api.ts
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îú‚îÄ‚îÄ businesses.ts
‚îÇ   ‚îú‚îÄ‚îÄ categories.ts
‚îÇ   ‚îú‚îÄ‚îÄ delivery.ts
‚îÇ   ‚îú‚îÄ‚îÄ employeeAuth.ts
‚îÇ   ‚îú‚îÄ‚îÄ orders.ts
‚îÇ   ‚îî‚îÄ‚îÄ users.ts
‚îú‚îÄ‚îÄ types/             # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ orders.ts
‚îú‚îÄ‚îÄ app.ts             # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ database.ts        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îî‚îÄ‚îÄ server.ts          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## API Endpoints

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/auth/login` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `GET /api/auth/profile` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ë–∏–∑–Ω–µ—Å—ã –∏ —Ç–æ–≤–∞—Ä—ã
- `GET /api/businesses` - –°–ø–∏—Å–æ–∫ –±–∏–∑–Ω–µ—Å–æ–≤
- `GET /api/businesses/:id/items` - –¢–æ–≤–∞—Ä—ã –±–∏–∑–Ω–µ—Å–∞
- `GET /api/categories` - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

### –ó–∞–∫–∞–∑—ã
- `POST /api/orders` - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `GET /api/orders` - –ó–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/orders/:id` - –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
- `PATCH /api/orders/:id/status` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (–¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)

### –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
- `POST /api/employee/auth/login` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
- `GET /api/employee/orders` - –ó–∞–∫–∞–∑—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `GET /api/users/search` - –ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤

### –î–æ—Å—Ç–∞–≤–∫–∞
- `POST /api/delivery/calculate` - –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### –ê–∫—Ü–∏–∏ –∏ —Å–∫–∏–¥–∫–∏
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∞–∫—Ü–∏–∏:
- **SUBTRACT** - –∞–∫—Ü–∏–∏ —Ç–∏–ø–∞ "2+1", "3+2"
- **DISCOUNT** - –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Å–∫–∏–¥–∫–∏

ID –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–π –∞–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `marketing_promotion_detail_id` —Ç–∞–±–ª–∏—Ü—ã `orders_items`.

### –î–æ—Å—Ç–∞–≤–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∞–¥—Ä–µ—Å–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Ä–∞—Å—á–µ—Ç–∞ –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
- Fallback –Ω–∞ Yandex API –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∑–∞–¥–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –≤—Ä—É—á–Ω—É—é

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π —Å bcrypt
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

## –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|----------|
| 0 | –ù–æ–≤—ã–π | –ó–∞–∫–∞–∑ —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω |
| 1 | –ü—Ä–∏–Ω—è—Ç | –ú–∞–≥–∞–∑–∏–Ω –ø—Ä–∏–Ω—è–ª –∑–∞–∫–∞–∑ |
| 2 | –°–æ–±—Ä–∞–Ω | –ó–∞–∫–∞–∑ —Å–æ–±—Ä–∞–Ω |
| 3 | –£ –∫—É—Ä—å–µ—Ä–∞ | –ü–µ—Ä–µ–¥–∞–Ω –∫—É—Ä—å–µ—Ä—É |
| 4 | –î–æ—Å—Ç–∞–≤–ª–µ–Ω | –ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω |
| 7 | –û—Ç–º–µ–Ω–µ–Ω | –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω |
| 66 | –ù–µ –æ–ø–ª–∞—á–µ–Ω | –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã |

## –¢–∏–ø—ã –¥–æ—Å—Ç–∞–≤–∫–∏

- **DELIVERY** - –û–±—ã—á–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
- **PICKUP** - –°–∞–º–æ–≤—ã–≤–æ–∑ (—Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ = 0)
- **SCHEDULED** - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤ `src/controllers/`
2. –î–æ–±–∞–≤—å—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ `src/routes/`
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ `src/routes/api.ts`
4. –û–±–Ω–æ–≤–∏—Ç–µ —Ç–∏–ø—ã –≤ `src/types/`

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Prisma –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î:
```typescript
import { prisma } from '../database';

const user = await prisma.user.findUnique({
  where: { user_id: 123 }
});
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `createError` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ—à–∏–±–æ–∫:
```typescript
import { createError } from '../middleware/errorHandler';

if (!user) {
  return next(createError(404, '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω'));
}
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npm run db:generate

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã —Å –ë–î (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
npm run db:push

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ app.ts                    # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Express
‚îú‚îÄ‚îÄ server.ts                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ database.ts               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prisma
‚îú‚îÄ‚îÄ controllers/              # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã API
‚îÇ   ‚îú‚îÄ‚îÄ userItemsController.ts # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ç–æ–≤–∞—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ businessController.ts  # –ë–∏–∑–Ω–µ—Å—ã –∏ –º–∞–≥–∞–∑–∏–Ω—ã
‚îú‚îÄ‚îÄ middleware/               # Middleware —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.ts      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ routes/                  # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ api.ts              # –ì–ª–∞–≤–Ω—ã–π API router
‚îÇ   ‚îú‚îÄ‚îÄ users.ts           # –ú–∞—Ä—à—Ä—É—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ businesses.ts      # –ú–∞—Ä—à—Ä—É—Ç—ã –±–∏–∑–Ω–µ—Å–æ–≤
‚îî‚îÄ‚îÄ types/                 # TypeScript —Ç–∏–ø—ã
```

## üõ† –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev          # –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
npm run build        # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build:watch  # –°–±–æ—Ä–∫–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm start            # –ó–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run clean        # –û—á–∏—Å—Ç–∫–∞ –ø–∞–ø–∫–∏ dist

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
npm run db:generate  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npm run db:push      # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ö–µ–º—ã –≤ –ë–î
npm run db:migrate   # –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
npm run db:studio    # –û—Ç–∫—Ä—ã—Ç–∏–µ Prisma Studio

# –£—Ç–∏–ª–∏—Ç—ã
npm run lint         # –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞ (TODO)
npm test            # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (TODO)
```

## üåê API Endpoints

### –ë–∞–∑–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
- `GET /api` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/api/users`)

#### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `GET /api/users` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/users/:id` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- `POST /api/users` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –¢–æ–≤–∞—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/users/:userId/items/business/:businessId` - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –±–∏–∑–Ω–µ—Å—É
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&categoryId=123&search=–º–æ–ª–æ–∫–æ`

#### –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- `GET /api/users/:userId/liked-items` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20`
- `POST /api/users/:userId/liked-items` - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  - Body: `{ "item_id": 123 }`
- `DELETE /api/users/:userId/liked-items/:itemId` - –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

### –ë–∏–∑–Ω–µ—Å—ã (`/api/businesses`)

#### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∏–∑–Ω–µ—Å–∞–º–∏
- `GET /api/businesses` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±–∏–∑–Ω–µ—Å—ã
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&city_id=1&search=–º–∞–≥–∞–∑–∏–Ω`
- `GET /api/businesses/:id` - –ü–æ–ª—É—á–∏—Ç—å –±–∏–∑–Ω–µ—Å –ø–æ ID

#### –¢–æ–≤–∞—Ä—ã –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–∏–∑–Ω–µ—Å–∞
- `GET /api/businesses/:businessId/items` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –±–∏–∑–Ω–µ—Å–∞
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&categoryId=123&search=–º–æ–ª–æ–∫–æ&inStock=true`
- `GET /api/businesses/:businessId/categories` - –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –±–∏–∑–Ω–µ—Å–∞

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ API

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
```json
{
  "success": true,
  "data": {
    // –î–∞–Ω–Ω—ã–µ
  },
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",
  "pagination": {  // –î–ª—è —Å–ø–∏—Å–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
    "current_page": 1,
    "per_page": 20,
    "total": 100,
    "total_pages": 5
  }
}
```

### –û—à–∏–±–∫–∞
```json
{
  "error": {
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "statusCode": 400,
    "timestamp": "2025-01-01T00:00:00.000Z",
    "path": "/api/users",
    "method": "GET"
  }
}
```

## ÔøΩÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MySQL —Å Prisma ORM –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∞–≤–∫–∏.

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
```bash
GET /api/users/1/items/business/5?page=1&limit=10&categoryId=2&search=–º–æ–ª–æ–∫–æ
```

#### –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
```bash
POST /api/users/1/liked-items
Content-Type: application/json

{
  "item_id": 123
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –±–∏–∑–Ω–µ—Å—ã –≤ –≥–æ—Ä–æ–¥–µ
```bash
GET /api/businesses?city_id=1&page=1&limit=20
```

## ÔøΩ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```env
# –°–µ—Ä–≤–µ—Ä
PORT=3000
NODE_ENV=development

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL
DATABASE_URL="mysql://shrvsets:0T86663dju35@67.205.143.36:3306/naliv"

# CORS
CORS_ORIGIN=http://localhost:3000
```
