# Naliv Backend API

TypeScript backend API –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∞–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π MySQL —á–µ—Ä–µ–∑ Prisma ORM.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Node.js 18+
- MySQL 8.0+
- npm –∏–ª–∏ yarn

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npm run db:generate

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã —Å –ë–î (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
npm run db:push

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ app.ts                    # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Express
‚îú‚îÄ‚îÄ server.ts                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ database.ts               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prisma
‚îú‚îÄ‚îÄ controllers/              # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã API
‚îÇ   ‚îú‚îÄ‚îÄ userItemsController.ts # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ç–æ–≤–∞—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ businessController.ts  # –ë–∏–∑–Ω–µ—Å—ã –∏ –º–∞–≥–∞–∑–∏–Ω—ã
‚îú‚îÄ‚îÄ middleware/               # Middleware —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.ts      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ routes/                  # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ api.ts              # –ì–ª–∞–≤–Ω—ã–π API router
‚îÇ   ‚îú‚îÄ‚îÄ users.ts           # –ú–∞—Ä—à—Ä—É—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ businesses.ts      # –ú–∞—Ä—à—Ä—É—Ç—ã –±–∏–∑–Ω–µ—Å–æ–≤
‚îî‚îÄ‚îÄ types/                 # TypeScript —Ç–∏–ø—ã
```

## üõ† –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev          # –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
npm run build        # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build:watch  # –°–±–æ—Ä–∫–∞ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm start            # –ó–∞–ø—É—Å–∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run clean        # –û—á–∏—Å—Ç–∫–∞ –ø–∞–ø–∫–∏ dist

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
npm run db:generate  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npm run db:push      # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ö–µ–º—ã –≤ –ë–î
npm run db:migrate   # –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
npm run db:studio    # –û—Ç–∫—Ä—ã—Ç–∏–µ Prisma Studio

# –£—Ç–∏–ª–∏—Ç—ã
npm run lint         # –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞ (TODO)
npm test            # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (TODO)
```

## üåê API Endpoints

### –ë–∞–∑–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
- `GET /api` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/api/users`)

#### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `GET /api/users` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/users/:id` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
- `POST /api/users` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –¢–æ–≤–∞—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/users/:userId/items/business/:businessId` - –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –±–∏–∑–Ω–µ—Å—É
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&categoryId=123&search=–º–æ–ª–æ–∫–æ`

#### –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- `GET /api/users/:userId/liked-items` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20`
- `POST /api/users/:userId/liked-items` - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  - Body: `{ "item_id": 123 }`
- `DELETE /api/users/:userId/liked-items/:itemId` - –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

### –ë–∏–∑–Ω–µ—Å—ã (`/api/businesses`)

#### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∏–∑–Ω–µ—Å–∞–º–∏
- `GET /api/businesses` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±–∏–∑–Ω–µ—Å—ã
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&city_id=1&search=–º–∞–≥–∞–∑–∏–Ω`
- `GET /api/businesses/:id` - –ü–æ–ª—É—á–∏—Ç—å –±–∏–∑–Ω–µ—Å –ø–æ ID

#### –¢–æ–≤–∞—Ä—ã –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–∏–∑–Ω–µ—Å–∞
- `GET /api/businesses/:businessId/items` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã –±–∏–∑–Ω–µ—Å–∞
  - Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `?page=1&limit=20&categoryId=123&search=–º–æ–ª–æ–∫–æ&inStock=true`
- `GET /api/businesses/:businessId/categories` - –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –±–∏–∑–Ω–µ—Å–∞

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ API

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
```json
{
  "success": true,
  "data": {
    // –î–∞–Ω–Ω—ã–µ
  },
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",
  "pagination": {  // –î–ª—è —Å–ø–∏—Å–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
    "current_page": 1,
    "per_page": 20,
    "total": 100,
    "total_pages": 5
  }
}
```

### –û—à–∏–±–∫–∞
```json
{
  "error": {
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "statusCode": 400,
    "timestamp": "2025-01-01T00:00:00.000Z",
    "path": "/api/users",
    "method": "GET"
  }
}
```

## ÔøΩÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MySQL —Å Prisma ORM –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∞–≤–∫–∏.

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
```bash
GET /api/users/1/items/business/5?page=1&limit=10&categoryId=2&search=–º–æ–ª–æ–∫–æ
```

#### –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
```bash
POST /api/users/1/liked-items
Content-Type: application/json

{
  "item_id": 123
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –±–∏–∑–Ω–µ—Å—ã –≤ –≥–æ—Ä–æ–¥–µ
```bash
GET /api/businesses?city_id=1&page=1&limit=20
```

## ÔøΩ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```env
# –°–µ—Ä–≤–µ—Ä
PORT=3000
NODE_ENV=development

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MySQL
DATABASE_URL="mysql://shrvsets:0T86663dju35@67.205.143.36:3306/naliv"

# CORS
CORS_ORIGIN=http://localhost:3000
```
